<!DOCTYPE html>
<html lang="en">

<head>
    <title>Gallery</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <link rel="shortcut icon" href="images/fevicon.png" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <a href="#main-content" class="visually-hidden-focusable">Skip to main content</a>

    <nav id="mainNavbar" class="navbar navbar-expand-lg navbar-dark fixed-top" style="background: var(--primary-color)">
        <div class="container">
            <a class="navbar-brand fw-bold" href="index.html">
                <img class="logo me-2" src="images/logo.png" alt="Special Children School Logo">
                Mukbadhir Nivasi Vidyalaya
            </a>
            <button class="navbar-toggler" aria-label="Toggle navigation" data-bs-toggle="collapse"
                data-bs-target="#menu">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="menu">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="about.html">About Us</a></li>
                    <li class="nav-item"><a class="nav-link" href="programs.html">Our Programs</a></li>
                    <li class="nav-item"><a class="nav-link" href="gallery.html">Gallery</a></li>
                    <li class="nav-item"><a class="nav-link" href="donation.html">Donate</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main id="main-content">

        <section class="section">
            <div class="container d-flex flex-column align-items-center">
                <div class="container d-flex flex-column align-items-center mb-7">
                    <h1 class="mb-4" data-aos="fade-up" data-aos-delay="100">Gallery Section</h1>
                    <h3 class="mb-4" data-aos="fade-up" data-aos-delay="200">Here you can view moments from our school's daily activities, teaching process, and various events.</h3>
                </div>
                <div class="row g-4 mt-4 gallery-grid" aria-live="polite">
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="0">
                            <img src="images/dd1.jpg" class="gallery-img" loading="lazy" alt="Special event with teacher and parent participation alongside deaf and hard-of-hearing students">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="550">
                        <figure class="gallery-item" tabindex="0" data-index="1">
                            <img src="images/dd2.jpg" class="gallery-img" loading="lazy" alt="Moment from an event at the entrance of the Mukbadhir Nivasi Vidyalaya, Akola">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="700">
                        <figure class="gallery-item" tabindex="0" data-index="2">
                            <img src="images/dd3.jpg" class="gallery-img" loading="lazy" alt="Rakhi celebration attended by dignitaries, teachers, and deaf and hard-of-hearing students">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="3">
                            <img src="images/dd4.jpg" class="gallery-img" loading="lazy" alt="Deaf and hard-of-hearing students joyfully participating in a special school program">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="4">
                            <img src="images/dd5.jpg" class="gallery-img" loading="lazy" alt="Various moments of daily activities and student participation at the school">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="5">
                            <img src="images/dd6.jpg" class="gallery-img" loading="lazy" alt="Officials interacting with students during a visit by the district evaluation committee">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="6">
                            <img src="images/dd7.jpg" class="gallery-img" loading="lazy" alt="Students and guests celebrating by cutting a cake at a school event">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="7">
                            <img src="images/dd8.jpg" class="gallery-img" loading="lazy" alt="Guiding students using modern tools for hearing training">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="8">
                            <img src="images/dd9.jpg" class="gallery-img" loading="lazy" alt="Organized provision of clean and nutritious meals for students">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="9">
                            <img src="images/dd10.jpg" class="gallery-img" loading="lazy" alt="Student attendance recorded using a biometric system at the school">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="10">
                            <img src="images/dd11.jpg" class="gallery-img" loading="lazy" alt="Inspection of hearing assessment equipment during the district evaluation committee visit">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="11">
                            <img src="images/dd12.jpg" class="gallery-img" loading="lazy" alt="Interaction between dignitaries and students at a special school event">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="12">
                            <img src="images/dd13.jpg" class="gallery-img" loading="lazy" alt="Campus of the Mukbadhir Nivasi Vidyalaya, Akola">
                        </figure>
                    </div>
                    <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="400">
                        <figure class="gallery-item" tabindex="0" data-index="13">
                            <img src="images/dd14.jpg" class="gallery-img" loading="lazy" alt="Organized nutritious meals for students and visiting dignitaries">
                        </figure>
                    </div>

                </div>

                <!-- LIGHTBOX -->
                <div id="lightbox" class="lightbox" aria-hidden="true" role="dialog" aria-modal="true">
                    <button class="lb-close" aria-label="Close">&times;</button>
                    <button class="lb-prev" aria-label="Previous">â€¹</button>
                    <div class="lb-content">
                        <img src="" alt="" id="lightbox-img">
                        <p class="lb-caption" id="lightbox-caption"></p>
                        <!-- Invisible touch zones to make mobile tapping easier -->
                        <div class="lb-touch-zone" aria-hidden="true">
                            <div class="lb-touch-left"></div>
                            <div class="lb-touch-right"></div>
                        </div>
                    </div>
                    <button class="lb-next" aria-label="Next">â€º</button>
                </div>
            </div>
                </section>

    </main>

    <footer class="text-center py-3">Â© 2026 Mukbadhir Nivasi Vidyalaya</footer>

    <!-- FLOATING WHATSAPP -->
    <a class="whatsapp-float" href="https://wa.me/+919822714405?text=Hello,%20I%20found%20information%20about%20your%20Residential%20School%20for%20the%20Deaf%20on%20the%20website.%20Please%20provide%20more%20information%20about%20the%20school%20and%20guidance%20on%20the%20contact%20process.%20Thank%20you." target="_blank">ðŸ’¬</a>

    <!-- same JS block -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
    <script>
        document.querySelectorAll('.navbar-nav .nav-link').forEach(link => {
            link.addEventListener('click', () => {
                const collapse = document.querySelector('.navbar-collapse');
                if (collapse.classList.contains('show')) new bootstrap.Collapse(collapse).hide();
            });
        });

        window.addEventListener('load', () => window.scrollTo(0, 0));

        const page = location.pathname.split("/").pop() || "index.html";
        document.querySelectorAll('.nav-link').forEach(link => {
            if (link.getAttribute("href") === page) link.classList.add("active");
        });

        let lastScroll = 0;
        const navbar = document.getElementById("mainNavbar");
        let scrollTicking = false;
        window.addEventListener("scroll", () => {
            if (!scrollTicking) {
                scrollTicking = true;
                requestAnimationFrame(() => {
                    const current = window.pageYOffset;
                    if (current > lastScroll && current > 100) navbar.classList.add("hide");
                    else navbar.classList.remove("hide");
                    lastScroll = current;
                    scrollTicking = false;
                });
            }
        }, { passive: true });

        AOS.init({ once: true });

        // Lightweight accessible lightbox for gallery (optimized)
        // set non-blocking decoding for images
        document.querySelectorAll('.gallery-img').forEach(img => {
            try { img.decoding = 'async'; img.setAttribute('fetchpriority', 'auto'); } catch (e) { }
        });

        (function () {
            const grid = document.querySelector('.gallery-grid');
            const lightbox = document.getElementById('lightbox');
            const lbImg = document.getElementById('lightbox-img');
            const lbCaption = document.getElementById('lightbox-caption');
            const btnClose = document.querySelector('.lb-close');
            const btnPrev = document.querySelector('.lb-prev');
            const btnNext = document.querySelector('.lb-next');
            if (!grid || !lightbox || !lbImg) return;
            let current = 0;
            let lastActive = null;

            function getItems() { return Array.from(document.querySelectorAll('.gallery-item')); }

            function showByIndex(index) {
                const items = getItems();
                if (!items.length) return;
                index = ((index % items.length) + items.length) % items.length;
                const item = items[index];
                if (!item) return;
                const img = item.querySelector('img');
                lbImg.src = img.src;
                lbImg.alt = img.alt || '';
                lbCaption.textContent = img.alt || '';
                lightbox.setAttribute('aria-hidden', 'false');
                current = index;
                lastActive = document.activeElement;
                btnClose && btnClose.focus();
            }

            function hide() {
                lightbox.setAttribute('aria-hidden', 'true');
                if (lastActive && typeof lastActive.focus === 'function') lastActive.focus();
            }

            function next() { showByIndex(current + 1); }
            function prev() { showByIndex(current - 1); }

            // Event delegation: single listener instead of per-item handlers
            grid.addEventListener('click', (e) => {
                const fig = e.target.closest('.gallery-item');
                if (!fig) return;
                e.preventDefault();
                const idx = getItems().indexOf(fig);
                if (idx >= 0) showByIndex(idx);
            });

            grid.addEventListener('keydown', (e) => {
                const fig = e.target.closest('.gallery-item');
                if (!fig) return;
                if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); const idx = getItems().indexOf(fig); if (idx >= 0) showByIndex(idx); }
            });

            btnClose && btnClose.addEventListener('click', hide);
            btnNext && btnNext.addEventListener('click', next);
            btnPrev && btnPrev.addEventListener('click', prev);
            lightbox.addEventListener('click', (e) => { if (e.target === lightbox) hide(); });

            document.addEventListener('keydown', (e) => {
                if (lightbox.getAttribute('aria-hidden') !== 'false') return;
                if (e.key === 'Escape') hide();
                if (e.key === 'ArrowRight') next();
                if (e.key === 'ArrowLeft') prev();
            });

            // Mobile / touch navigation: tap left/right halves to prev/next
            const touchLeft = document.querySelector('.lb-touch-left');
            const touchRight = document.querySelector('.lb-touch-right');
            if (touchLeft && touchRight) {
                touchLeft.addEventListener('click', (e) => { e.stopPropagation(); prev(); });
                touchRight.addEventListener('click', (e) => { e.stopPropagation(); next(); });
                lbImg.addEventListener('touchend', (e) => {
                    if (!e.changedTouches || !e.changedTouches[0]) return;
                    const rect = lbImg.getBoundingClientRect();
                    const x = e.changedTouches[0].clientX - rect.left;
                    const rel = x / rect.width;
                    if (rel < 0.4) prev();
                    else if (rel > 0.6) next();
                }, { passive: true });
                lbImg.addEventListener('click', (e) => {
                    const rect = lbImg.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const rel = x / rect.width;
                    if (rel < 0.4) prev();
                    else if (rel > 0.6) next();
                });
            }
        })();
        // Mobile / touch navigation: tap left/right halves to prev/next
        const touchLeft = document.querySelector('.lb-touch-left');
        const touchRight = document.querySelector('.lb-touch-right');
        if (touchLeft && touchRight) {
            touchLeft.addEventListener('click', (e) => { e.stopPropagation(); prev(); });
            touchRight.addEventListener('click', (e) => { e.stopPropagation(); next(); });
            // Also support touchend on the image itself for broader area
            lbImg.addEventListener('touchend', (e) => {
                if (!e.changedTouches || !e.changedTouches[0]) return;
                const rect = lbImg.getBoundingClientRect();
                const x = e.changedTouches[0].clientX - rect.left;
                const rel = x / rect.width;
                if (rel < 0.4) prev();
                else if (rel > 0.6) next();
            }, { passive: true });
            lbImg.addEventListener('click', (e) => {
                const rect = lbImg.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const rel = x / rect.width;
                if (rel < 0.4) prev();
                else if (rel > 0.6) next();
            });
        }
        ;

        // Group gallery images by aspect ratio (landscape / square / portrait)
        (function () {
            const grid = document.querySelector('.gallery-grid');
            if (!grid) return;
            const items = Array.from(grid.querySelectorAll('.col-6'));

            function aspectCategory(img) {
                const w = img.naturalWidth || img.width || 1;
                const h = img.naturalHeight || img.height || 1;
                const r = w / h;
                if (r > 1.15) return 'landscape';
                if (r < 0.85) return 'portrait';
                return 'square';
            }

            // Wait until images are loaded so natural sizes are available
            const imgPromises = items.map(it => new Promise(res => {
                const img = it.querySelector('img');
                if (!img) return res();
                if (img.complete && img.naturalWidth) return res();
                img.addEventListener('load', () => res());
                img.addEventListener('error', () => res());
            }));

            Promise.all(imgPromises).then(() => {
                const buckets = { landscape: [], square: [], portrait: [] };
                items.forEach(it => {
                    const img = it.querySelector('img');
                    const cat = img ? aspectCategory(img) : 'square';
                    buckets[cat].push(it);
                });

                // Re-append in grouped order: landscape, square, portrait
                const order = ['landscape', 'square', 'portrait'];
                order.forEach(k => {
                    buckets[k].forEach(el => grid.appendChild(el));
                });
            });
        })();
    </script>
</body>

</html>